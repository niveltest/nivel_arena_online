# 実装計画: オーディオシステムの統合とNikke風サウンド対応

## 概要

現在、簡易的な `SoundManager.ts` と高機能な `AudioManager.ts` が混在しています。これらを統合し、`AudioManager.ts` を正として利用するように変更します。また、外部URLへの依存を排除し、ローカルの `/audio/` ディレクトリを参照するように変更することで、ユーザーが任意の音声ファイル（Nikkeの音声など）を配置してカスタマイズできるようにします。

## 変更内容

### 1. `utils/AudioManager.ts` の拡張

- **ファイルマッピング機能の追加**: 論理的なイベント名（例: `play_card`）と物理ファイル名（例: `/audio/se_card_play.mp3`）をマッピングする機能を追加します。
- **拡張子対応**: `.mp3`, `.wav`, `.ogg` など複数の形式に対応できるようにします（基本は mp3 推奨）。

### 2. `utils/SoundManager.ts` のリファクタリング (Adapter Pattern)

- 既存の `SoundManager` クラスを `AudioManager` のラッパーとして書き換えます。これにより、`GameBoard.tsx` などの既存コードを変更することなく、裏側の処理を `AudioManager` に切り替えることができます。

### 3. ファイル配置ガイドの作成

- `public/audio/README.md` を更新し、どのファイル名で保存すればどの音が変わるかのリストを明記します。

### 4. BGM再生の実装

- `GameBoard.tsx` のマウント時に `bgm_battle` を再生する処理を追加します。
- ミュート機能のUIへの組み込み（今回はコンソール制御または簡易ボタンでの対応を検討）。

## ユーザー定義ファイル名一覧 (予定)

ユーザーは以下のファイル名で `public/audio/` にファイルを配置することで、音声をカスタマイズできます。

| イベント | ファイル名 (推奨) | 説明 |
| :--- | :--- | :--- |
| **BGM** | | |
| バトル中 | `bgm_battle.mp3` | 対戦中の主要BGM |
| **SE** | | |
| カードドロー | `se_draw.mp3` | ドロー時の音 |
| カードプレイ | `se_play_card.mp3` | ユニット/スペル使用時 |
| 攻撃開始 | `se_attack_start.mp3` | 攻撃宣言時 (銃撃音など) |
| 攻撃ヒット | `se_attack_hit.mp3` | ダメージ発生時 |
| ユニット破壊 | `se_destroy.mp3` | ユニットが破壊された時 |
| レベルアップ | `se_levelup.mp3` | コスト回復/覚醒時 |
| 勝利 | `se_victory.mp3` | ゲーム勝利時 |
| 敗北 | `se_defeat.mp3` | ゲーム敗北時 |

## 検証計画

1. `SoundManager` を書き換えた後、ゲームを起動しエラーが出ないか確認。
2. ダミーの空ファイルを作成し、イベント時にログが出るか、あるいは404エラー（取得試行）が出ることで動作を確認。
