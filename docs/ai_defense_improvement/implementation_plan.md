# AI 戦略的強化：防御ロジックの改善

## 目標

AIがより「賢く」防御を行えるようにします。単に勝てる時だけブロックするのではなく、ユニットの重要度（バフ役、キーカード）やライフの危険度、特殊能力（道連れ等）を考慮した意思決定を実装します。

## 変更内容

### [Server] AIロジック (`server/AIPlayer.ts`)

- **`evaluateThreat` の強化**:
  - ユニットが「他者を強化する能力」や「強力な常時能力」を持っている場合のスコアを加算。
  - ユニットのタイプ（LEADERは最高値、トークンは低値など）を考慮。

- **`handleGuardianIntercept` の新設**:
  - `GUARDIAN_INTERCEPT` フェイズに対応。
  - 以下の条件で「防壁」ユニットによる身代わりを検討：
    - 攻撃対象が「高スコアの重要ユニット」である場合。
    - ライフが少なく、直接攻撃（フェイズ移行前）を受けそうな場合。
    - 防壁ユニット自身がこの戦闘で生き残れる場合。

- **`handleDefensePhase` の改善**:
  - ユニットの価値スコアを基準に判断：
    - **重要ユニット（高スコア）**: 確実に勝てる場合（パワー勝負で一方的破壊）のみブロック。
    - **囮・一般ユニット（低スコア）**: 自分が破壊されてもライフを守れるなら積極的にブロック。
    - **道連れ（REVENGE）持ち**: 相手の強力なユニットを道連れにできるなら、自分が破壊されてもブロック。

- **`think` メソッドの更新**:
  - `GUARDIAN_INTERCEPT` フェイズのハンドラを追加。

## 検証計画

- `unitTestAI.ts` に防御シナリオテストを追加：
  - 「重要なバフユニットを無視して、囮ユニットでブロックするか」の確認。
  - 「防壁ユニットが正しく身代わりに入るか」の確認。
  - 「HPが低い時に決死のブロックを行うか」の確認。
