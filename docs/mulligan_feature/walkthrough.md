# マリガン機能の実装完了報告

ゲーム開始時の手札引き直し機能（マリガン）を実装しました。

## 実装内容

### 1. ゲームフローの変更

ゲーム開始後の流れが以下のように変更されました：

1. デッキ生成・シャッフル
2. 各プレイヤーが5枚ドロー
3. **マリガンフェーズ開始**（新設）
4. 両プレイヤーが確定後、第1ターンのレベルアップへ

### 2. マリガン処理の詳細（公式ルール準拠）

- マリガンを行う場合、**手札5枚すべて**をデッキに戻す必要があります（一部のみの交換は不可）。
- デッキの底に手札を戻した後、新しく5枚ドローします。
- その後、デッキをシャッフルします。

### 3. UI/UX の向上

- 引き直し画面では、いずれかのカードをクリックすると手札すべてが選択状態になり、「MULLIGAN ALL (すべて引き直す)」ボタンが表示されます。
- 1枚も選択していない状態では「KEEP ALL (このまま開始)」となり、現在の5枚でゲームを開始します。
- 片方のプレイヤーが完了している間、もう片方のプレイヤーを待っている間も状態が同期されます。

## 検証結果

- [x] ゲーム開始時に正しくマリガンモーダルが表示される。
- [x] カード選択・解除が正しく機能する。
- [x] 「KEEP ALL」を押した場合、手札が変わらずに完了状態になる。
- [x] 引き直しを行った場合、新しいカードがドローされ、古いカードがデッキに戻る。
- [x] 両名完了後に第1ターンが正常に開始される。
