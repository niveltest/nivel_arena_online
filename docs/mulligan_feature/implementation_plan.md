# マリガン機能の実装計画

ゲーム開始時に手札の引き直し（マリガン）ができる機能を追加します。

## ユーザーレビューが必要な項目

- **マリガンルール**: 公式ルールに基づき、「任意の枚数を選択してデッキの下に戻し、戻した枚数分ドローしてからシャッフルする」形式で実装しました。
- **UI表示**: ゲーム開始直後に全プレイヤーに対して引き直し選択画面が表示されます。

## 変更内容

### 共有型定義 (shared/types.ts)

- `GameState` に `MULLIGAN` フェーズを追加。
- `Player` に `mulliganDone` フラグを追加し、進行状況を管理。

### サーバーロジック (server/Game.ts, server/index.ts)

- `start()` メソッドの開始フェーズを `MULLIGAN` に変更。
- `resolveMulligan` メソッドを実装し、選ばれたカードの交換を処理。
- 両プレイヤーが完了したら `LEVEL_UP` フェーズに移行。

### フロントエンド (components/GameBoard.tsx, components/SelectionModal.tsx)

- `MULLIGAN` フェーズ中、手札選択用のモーダルを表示。
- 0枚選択（すべてキープ）を許可し、ボタン表示を「KEEP ALL」に変更。

## 検証計画

### マニュアル確認

1. ゲームを開始し、最初に5枚ドローされた後に引き直し画面が出るか確認。
2. 任意のカード（0枚〜5枚）を選択して「MULLIGAN SELECTED」または「KEEP ALL」を押す。
3. カードが正しく入れ替わり、両プレイヤーが完了した後に第1ターン（レベルアップ）が始まるか確認。
