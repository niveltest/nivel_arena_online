# 公式カード統合およびデッキバリデーション 実装計画

取得済みの公式カードデータ（バッチファイル）を `server/data/cards.json` に統合し、リーダーの属性に合わせたデッキ構築ルールを実装します。

## ユーザーレビューが必要な項目
>
> [!IMPORTANT]
> 既存のテスト用カード（`c001` 等のID）を公式データに置き換えます。ID体系が `BT01-xxx` 等に変更されるため、既存のデバッグ用デッキデータが動作しなくなる可能性があります。

## 提案される変更

### 1. カードデータの統合

- **スクリプトの作成**: `server/scripts/merge_cards.ts` を作成し、`batch_1` および `batch_2` のカードを既存の `cards.json` のフォーマット（`trigger`, `action` 等のエフェクト構造）に変換して統合します。
- **データクリーンアップ**: 公式データと重複する、または不要になった古いテストデータを削除します。

### 2. デッキバリデーションの実装

- **リーダーデータの拡張**: 全てのリーダーカードに属性（`attribute`）が正しく設定されていることを確認します。
- **バリデーションロジック**: `server/deckValidation.ts` を作成/更新し、以下のルールを実装します：
  - デッキ枚数: 40枚（メイン） + 1枚（リーダー）
  - 属性制限: リーダーの属性と一致するカード、または「無属性/ニュートラル」のみ使用可能
  - 枚数制限: 同名カードは3枚まで
  - トリガー制限: トリガーカードは最大8枚まで

## 検証計画

### 自動テスト

- `merge_cards.ts` を実行し、生成された `cards.json` が有効なJSONであり、型定義に合致することを確認します。
- デッキバリデーション関数のユニットテストを作成し、不正なデッキが正しくリジェクトされるか確認します。

### 手動確認

- ゲーム画面で、新しく追加された公式カードが正しく表示されることを確認します。
