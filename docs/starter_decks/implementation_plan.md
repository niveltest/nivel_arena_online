# スターターデッキ実装計画

カスタムデッキを構築していないプレイヤーが、あらかじめ用意されたデッキを選択してすぐにゲームを開始できるようにします。

## ユーザーレビューが必要な項目

> [!IMPORTANT]
> `cards.json` を確認したところ、現在利用可能な属性は **炎、大地、嵐、波濤、稲妻** の5つのみでした。
> ユーザー様が挙げられた「光、闇」については、現在のデータセット（BT01, BT02, ST01-ST05）には含まれていないようです。
> そのため、今回はこれら5つの属性に対してスターターデッキを用意する計画です。

## 提案される変更点

### 1. スターターデッキの構成定義

調査の結果、各スターターデッキはリーダー1枚 + メインデッキ40枚で構成されていることが確認できました。具体的に以下の構成で `server/data/starterDecks.json` を作成します。

#### ST01 〈Counters〉 (炎)

- **Leader**: ST01-001 (1)
- **Units**:
  - (C) ST01-002, 003, 004, 005, 007 × 各3枚 / ST01-009 × 2枚
  - (R) ST01-006 × 3枚 / ST01-008 × 2枚
  - (SR) ST01-010, 011 × 各2枚
- **Skills**:
  - (C) ST01-012, 014 × 各3枚 / ST01-013, 015 × 各2枚
- **Items**:
  - (C) ST01-016, 017 × 各2枚

#### ST02 〈Real Kindness〉 (大地)

- **Leader**: ST02-001 (1)
- **Units**:
  - (C) ST02-002, 003, 004, 005, 006 × 各3枚 / ST02-011 × 2枚
  - (R) ST02-007 × 2枚 / ST02-008 × 3枚
  - (SR) ST02-009, 010 × 各2枚
- **Skills**:
  - (C) ST02-012, 013 × 各3枚 / ST02-014, 015 × 各2枚
- **Items**:
  - (C) ST02-016, 017 × 各2枚

#### ST03 〈Heretic〉 (嵐)

- **Leader**: ST03-001 (1)
- **Units**:
  - (C) ST03-002, 004, 005, 007, 008 × 各3枚 / ST03-009 × 2枚
  - (R) ST03-006 × 3枚 / ST03-010 × 2枚
  - (SR) ST03-003, 011 × 各2枚
- **Skills**:
  - (C) ST03-012, 013 × 各3枚 / ST03-014, 015 × 各2枚
- **Items**:
  - (C) ST03-016, 017 × 各2枚

#### ST04 〈Inherit〉 (波濤)

- **Leader**: ST04-001 (1)
- **Units**:
  - (C) ST04-002, 003, 004, 005, 006 × 各3枚 / ST04-009 × 2枚
  - (R) ST04-008 × 3枚 / ST04-010 × 2枚
  - (SR) ST04-007, 011 × 各2枚
- **Skills**:
  - (C) ST04-012, 014 × 各3枚 / ST04-013, 015 × 各2枚
- **Items**:
  - (C) ST04-016, 017 × 各2枚

#### ST05 〈Maid For You〉 (稲妻)

- **Leader**: ST05-001 (1)
- **Units**:
  - (C) ST05-002, 003, 004, 005 × 各3枚 / ST05-008, 009 × 各2枚
  - (R) ST05-007 × 3枚 / ST05-010 × 2枚
  - (SR) ST05-006, 011 × 各2枚
- **Skills**:
  - (C) ST05-013, 015 × 各3枚 / ST05-012, 014 × 各2枚
- **Items**:
  - (C) ST05-017 × 3枚 / ST05-016 × 2枚

### 2. ロビー画面 ([Lobby.tsx](file:///c:/Users/worke/Antigravity/nivel_arena_online/components/Lobby.tsx))

- デッキ選択用のドロップダウンまたはボタンリストを追加します。
- 「カスタムデッキ」または「スターターデッキ（属性名）」を選択できるようにします。

### 4. リーダー攻撃時の処理自動化

- **Game.ts**: `finalizeAttackResolution` において、防御側スロットが空（ユニットがいない）場合は、フェイズを `DEFENSE` に遷移させず、直ちに `dealDamage` を実行して `ATTACK` フェイズに戻るように変更します。
- **ダメージ計算**: `dealDamage` に攻撃側ユニットの `hitCount` を渡し、複数ダメージ（貫通や潜入など）に対応します。

## 検証計画

### 自動テスト

- [ ] サーバー側で各スターターデッキが正しく構成されることを確認するテストを作成。

### 手動確認

- [ ] ロビーでスターターデッキを選択してゲームを開始し、指定されたカードがデッキに含まれていることを確認。
- [ ] リーダーカードが正しく設定されていることを確認。
