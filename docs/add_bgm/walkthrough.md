# 戦闘外BGMの追加 (Add Non-Combat BGM) Walkthrough

戦闘中以外のシーン（ロビー、デッキ構築、勝利/敗北）でBGMが流れるように実装しました。

## 実施内容

### 1. 音声ファイルの準備

実際の音声ファイルが入手できるまでの暫定対応として、既存の `bgm_battle.mp3` を複製して以下のファイルを作成しました。

- `public/audio/bgm_lobby.mp3`
- `public/audio/bgm_deck.mp3`
- `public/audio/bgm_victory.mp3`
- `public/audio/bgm_defeat.mp3`

### 2. オーディオ管理システムの拡張

- **`utils/AudioManager.ts`**: 新しいBGMキーとファイルパスの定義を追加しました。
- **`utils/SoundManager.ts`**: 新しいBGMキーに対応させるとともに、`bgm_` で始まるキーを自動的に BGM チャンネルで再生する共通ロジックを実装しました。

### 3. 各画面でのBGM再生トリガーの実装

- **ロビー (`Lobby.tsx`)**: 画面表示時（マウント時）にロビーBGMを再生。
- **デッキ構築 (`DeckBuilder.tsx`)**: 画面表示時にデッキ構築BGMを再生。
- **ゲーム画面 (`GameBoard.tsx`)**:
  - ゲーム開始時は従来の戦闘BGMを再生。
  - **勝敗決定時**: 勝利時は勝利BGM、敗北時は敗北BGMに切り替わるように設定しました。

## 確認手順（手動）

1. **ロビー画面**: アプリを起動またはリロードし、BGMが流れることを確認してください。
2. **デッキ構築**: 「Deck Builder」ボタンを押し、BGMが継続（または切り替わり）することを確認してください。
3. **ゲーム開始**: ルームを作成または参加し、対戦が始まると戦闘BGMに切り替わることを確認してください。
4. **ゲーム終了**: ダメージを受け切るか「降参」を行い、勝敗リザルト表示とともに専用のBGMが流れることを確認してください。

> [!NOTE]
> ブラウザの仕様（自動再生ポリシー）により、ページをリロードした直後はユーザーが一度画面をクリックするまで音声が流れない場合があります。

## 今後の対応

- 今回作成したダミーファイル（mp3）を、後ほど本物のBGMファイルに差し替えることで、各シーンに合った演出が完成します。
