# 修正計画：CPUが防御フェーズで停止する問題の解消

## 現状の課題

- **CPUのフリーズ**: CPU戦において、ユーザーが攻撃を仕掛けた際、CPUが防御の選択（BLOCK/TAKE）を行わずに停止してしまうことがある。
- **原因の推測**: `AIPlayer.ts` 内で `think()` が再帰的に呼び出される際、サーバーの状態更新と競合が発生し、本来反応すべき `DEFENSE` フェーズの通知を見逃している可能性がある。

## 変更内容

### サーバー側 (`AIPlayer.ts`)

- `handleMainPhase` 内の再帰的な `this.think()` 呼び出しを削除。
- アクション後の思考は、サーバーからの状態更新（broadcastState）を起点とする元のフローに任せることで、並行処理による競合を回避する。

## 検証計画

- サーバーをデプロイし、CPU戦を開始する。
- ユーザーのターンに、CPUのユニットまたはリーダーに対して攻撃を行い、CPUが正しく防御（またはダメージを受ける）アクションを実行することを確認する。
