# 対戦準備フローの洗練（マリガン・先行後攻・属性チェック）

カードキーワードの実装が完了したため、ゲーム開始時のフローをより完成度の高いものに洗練します。

## 実施内容

### 1. デッキ構築の整合性チェック

- **`server/Game.ts`**:
  - `start` メソッドにて、プレイヤーが持ち込んだデッキがリーダーの属性と一致しているかチェックし、不正な場合は警告を表示してスキップするロジックを追加しました。

### 2. 先行・後攻の決定

- **`server/Game.ts`**:
  - ゲーム開始時にプレイヤーリストからランダムに先行 (`turnPlayerId`) を決定するように修正しました。

### 3. マリガン (MULLIGAN) フェーズの実装

- **`server/Game.ts`**:
  - `MULLIGAN` フェーズを導入。
  - 初期手札から不要なカードを選んでデッキに戻し、引き直すロジックを `resolveSelection` に実装。

### 4. 初期手札の配布

- **`server/Game.ts`**:
  - 先行プレイヤーの初ターンでのドロー制限を確認し、先行・後攻のバランスを担保しました。

## 検証計画

- ゲーム開始時に属性不一致のデッキで開始しようとした際、エラーまたは自動修正が行われることを確認。
- マリガン画面が表示され、カードを選択して引き直せることを確認。
- 両プレイヤーのマリガン完了後に初ターンが開始されることを確認。
