# 公式ルール準拠：完了報告

公式サイトの解説に基づき、ゲームロジックを公式ルール $(Ver. 1.3)$ に完全準拠するようにアップデートしました。

## 実施内容

### 1. マリガンの仕様修正

- 全交換（5枚すべて戻して5枚引く）1回のみのルールに変更しました。中途半端な枚数の交換はできなくなっています。

### 2. サイズ計算ロジック

- コスト上限（サイズ）の計算式を `リーダーレベル + ダメージ(damageZone.length)` に修正しました。ダメージを受けるほど、より強力なユニットやアイテムを場に出せるようになります。

### 3. ユニットアップグレード（上書き）

- 既にユニットがいる場所に、より高いコストのユニットを配置できるようになりました。
- 既存ユニットと装備品はトラッシュに送られ、この際の離脱では `エグジット` 効果は発動しません（公式ルール通り）。

### 4. 逐次ダメージチェックとトリガー

- ダメージを1枚ずつ山札からめくる方式に変更しました。
- めくったカードが `[トリガー]` を持っていた場合、即座にダメージチェックを終了し、残りのダメージを無効化（肩代わり）します。

### 5. 手札枚数制限

- エンドフェイズ時に手札が8枚以上ある場合、7枚になるまで選んで捨てるように修正しました。

### 6. デッキ構築制限の強制

- 同名カード3枚制限、トリガーカード8枚制限、リーダーとデッキカードの属性一致をゲーム開始時に厳密にチェックするようにしました。

## 検証結果

- ダメージチェック時にトリガーが捲れると、ログが表示され残りのダメージ処理がスキップされることを確認。
- ダメージが増えるにつれて、プレイ可能なカードのコスト上限が動的に増えることを確認。
- エンドフェイズ時に手札上限を超えているプレイヤーにディスカード要求が飛ぶことを確認。

---
`docs/official_rules/` 以下に関連ドキュメントを保存しました。

- [task.md](file:///c:/Users/worke/Antigravity/nivel_arena_online/docs/official_rules/task.md)
- [implementation_plan.md](file:///c:/Users/worke/Antigravity/nivel_arena_online/docs/official_rules/implementation_plan.md)
- [walkthrough.md](file:///c:/Users/worke/Antigravity/nivel_arena_online/docs/official_rules/walkthrough.md)
